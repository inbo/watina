<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get locations from the database — get_locs • watina</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Get locations from the database — get_locs"><meta property="og:description" content="Returns locations (and optionally, observation wells) from the Watina
database that meet
several criteria, either as a lazy object or as a
local tibble.
Criteria refer to spatial or non-spatial physical attributes of the
location or the location's observation wells.
Essential metadata are included in the result."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">watina</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/v010_getstarted.html">Getting started: connecting and selecting locations</a>
    </li>
    <li>
      <a href="../articles/v110_xg3.html">Using XG3 values to characterize and select locations</a>
    </li>
    <li>
      <a href="../articles/v210_chem.html">Using hydrochemical data to characterize and select locations</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/inbo/watina/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get locations from the database</h1>
    <small class="dont-index">Source: <a href="https://github.com/inbo/watina/blob/HEAD/R/get.R" class="external-link"><code>R/get.R</code></a></small>
    <div class="hidden name"><code>get_locs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Returns locations (and optionally, observation wells) from the <em>Watina</em>
database that meet
several criteria, either as a lazy object or as a
local tibble.
Criteria refer to spatial or non-spatial physical attributes of the
location or the location's observation wells.
Essential metadata are included in the result.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">get_locs</span><span class="op">(</span>
  <span class="va">con</span>,
  filterdepth_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,
  filterdepth_guess <span class="op">=</span> <span class="cn">FALSE</span>,
  filterdepth_na <span class="op">=</span> <span class="cn">FALSE</span>,
  obswells <span class="op">=</span> <span class="cn">FALSE</span>,
  obswell_aggr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"latest"</span>, <span class="st">"latest_fd"</span>, <span class="st">"latest_sso"</span>, <span class="st">"mean"</span><span class="op">)</span>,
  mask <span class="op">=</span> <span class="cn">NULL</span>,
  join_mask <span class="op">=</span> <span class="cn">FALSE</span>,
  buffer <span class="op">=</span> <span class="fl">10</span>,
  bbox <span class="op">=</span> <span class="cn">NULL</span>,
  area_codes <span class="op">=</span> <span class="cn">NULL</span>,
  loc_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"S"</span>, <span class="st">"R"</span>, <span class="st">"N"</span>, <span class="st">"W"</span>, <span class="st">"D"</span>, <span class="st">"L"</span>, <span class="st">"B"</span><span class="op">)</span>,
  loc_validity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"VLD"</span>, <span class="st">"ENT"</span><span class="op">)</span>,
  loc_vec <span class="op">=</span> <span class="cn">NULL</span>,
  collect <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>con</dt>
<dd><p>A <code>DBIConnection</code> object to Watina.
See <code><a href="connect_watina.html">connect_watina</a></code> to generate one.</p></dd>
<dt>filterdepth_range</dt>
<dd><p>Numeric vector of length 2.
Specifies the allowed range of the depth of the filter below soil
surface, as meters (minimum and maximum allowed filterdepth, respectively).
This condition is only applied to groundwater piezometers.
The second vector element cannot be smaller than the first.
Note that 'filterdepth' takes into account <em>half</em> the length of the
filter.
It is always assumed that filters are at the bottom of the tube.
Hence
<code>filterdepth = tubelength - filterlength / 2 -
[tubelength part above soil surface]</code>.
If filterlength is missing, it is assumed to be 0.3 m.
With <code>obswells = FALSE</code>, a location is kept whenever one observation
well fulfills the condition.</p></dd>
<dt>filterdepth_guess</dt>
<dd><p>Logical.
Only relevant for groundwater piezometers.
Defaults to <code>FALSE</code>.
For observation wells of which tubelength is known, but not
the part of the tubelength above soil surface (height of measuring point),
filterdepth cannot be calculated and is missing.
However, filterdepth will never be larger than tubelength minus half the
filterlength; hence a maximum
possible (i.e. conservative) value for filterdepth is given by
<code>tubelength - filterlength / 2</code>.
With <code>filterdepth_guess = TRUE</code>, filterdepth is replaced by this value
when it cannot be calculated and tubelength is available.
This is done before applying the <code>filterdepth_range</code> condition.
To mark these cases, a logical variable <code>filterdepth_guessed</code> is added
to the result: <code>TRUE</code> for wells where filterdepth was replaced;
<code>FALSE</code> in all other rows.</p></dd>
<dt>filterdepth_na</dt>
<dd><p>Logical.
Are observation wells with missing filterdepth value to be included?
Defaults to <code>FALSE</code>.
With <code>filterdepth_guess = TRUE</code>, this has only effect on the
<em>remaining</em> observation wells with missing filterdepth value.</p></dd>
<dt>obswells</dt>
<dd><p>Logical.
If <code>TRUE</code>, the returned object distinguishes all observation wells
(see <em>Details</em>) that
meet the <code>filterdepth_range</code> condition (or have missing filterdepth, if
<code>filterdepth_na = TRUE</code>).
If <code>FALSE</code> (the default), the returned object just distinguishes
locations.
In the latter case, the variables <code>obswell_installdate</code> and
<code>obswell_stopdate</code> are not returned.</p></dd>
<dt>obswell_aggr</dt>
<dd><p>String.
Defines how the attributes of multiple observation wells per location that
fulfill the <code>filterdepth_range</code> and
<code>filterdepth_na</code> criteria (after filterdepth adjustment if
<code>filterdepth_guess = TRUE</code>), are
aggregated into one record <strong>per location</strong>:</p><ul><li><p><code>"latest"</code>: return attributes of the most recent observation well
that fulfills the <code>filterdepth_range</code> and
<code>filterdepth_na</code> criteria;</p></li>
<li><p><code>"latest_fd"</code>: return attributes of the most recent observation well
that fulfills the <code>filterdepth_range</code> condition, i.e.
filterdepth will not be missing unless <em>all</em> retained wells have missing
filterdepth <em>and</em> <code>filterdepth_na = TRUE</code>;</p></li>
<li><p><code>"latest_sso"</code>: return attributes of the most recent observation well
that fulfills the <code>filterdepth_range</code> and
<code>filterdepth_na</code> criteria <em>and</em> for which <code>soilsurf_ost</code>
(soil surface level in the
<a href="http://crs.bkg.bund.de/crseu/crs/eu-description.php?crs_id=Y0JFX09PU1QrJTJGK1VOQ09S" class="external-link">Ostend height</a>
CRS (EPSG <a href="https://epsg.io/5710" class="external-link">5710</a>) is not missing (unless
<em>all</em> retained wells have missing <code>soilsurf_ost</code>);</p></li>
<li><p><code>"mean"</code>: aggregation not by selecting an individual observation
well, but by averaging the values of the associated variables
<code>soilsurf_ost</code>,
<code>measuringref_ost</code>,
<code>tubelength</code>,
<code>filterlength</code>,
<code>filterdepth</code>
for the observation wells with non-missing values (different
wells may be involved for each variable, depending on the distribution of
missing values).
With <code>filterdepth_guess = TRUE</code>, the extra variabele
<code>filterdepth_guessed</code> is summarised as <code>TRUE</code> for a location
if at least one of the location's observation wells has
<code>filterdepth_guessed = TRUE</code>.</p></li>
</ul><p><strong>In all cases</strong> the returned value of <code>obswell_statecode</code> and
<code>obswell_state</code> corresponds to the <code>"latest"</code> approach.
The <code>obswell_aggr</code> argument has no effect on locations with a single
retained observation well.
It is ignored if <code>obswells = TRUE</code>.</p></dd>
<dt>mask</dt>
<dd><p>An optional geospatial filter of class <code>sf</code>.
If provided, only locations that intersect with <code>mask</code> will be returned,
with the value of <code>buffer</code> taken into account.
The CRS must be Belgian Lambert 72 (EPSG-code
<a href="https://epsg.io/31370" class="external-link">31370</a>).</p></dd>
<dt>join_mask</dt>
<dd><p>Logical.
Do you want to spatially join the attribute columns of <code>mask</code> to the
resulting tibble?
The spatial join is executed with
<code><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_intersects()</a></code> as the topological operator.
Beware: if the same location intersects with more than one element of
<code>mask</code> (taking into account the value of <code>buffer</code>), that location
will occur multiple times in the result.
<code>join_mask</code> is ignored if <code>mask</code> is not provided.</p></dd>
<dt>buffer</dt>
<dd><p>Number of meters taken as a buffer to enlarge
<code>mask</code> (or shrink it, if <code>buffer &lt; 0</code>) if <code>mask</code> is provided.</p></dd>
<dt>bbox</dt>
<dd><p>Optional geospatial fiter (rectangle).
A bounding box (class <code>bbox</code>), or a vector of four named elements
<code>xmin</code>, <code>xmax</code>, <code>ymin</code>, <code>ymax</code> defining the
boundary coordinates of a bounding box.
If provided, only locations within this rectangular area will be returned.
The CRS must be Belgian Lambert 72 (EPSG-code
<a href="https://epsg.io/31370" class="external-link">31370</a>).</p></dd>
<dt>area_codes</dt>
<dd><p>An optional vector with area codes.
If provided, only locations within the areas will be returned.</p></dd>
<dt>loc_type</dt>
<dd><p>Type of the location (mainly: the type of measurement device).
Defaults to <code>"P"</code>, i.e. only groundwater piezometers are returned by
default.
Can be a vector with multiple selected values.</p></dd>
<dt>loc_validity</dt>
<dd><p>Validation status of the location.
Can be a vector with multiple selected values, which must belong to
<code>"VLD"</code>, <code>"ENT"</code>, <code>"DEL"</code> or <code>"CLD"</code>.
Defaults to <code>c("VLD", "ENT")</code>.</p></dd>
<dt>loc_vec</dt>
<dd><p>An optional vector with location codes.
If provided, only locations are returned that are present in this vector.</p></dd>
<dt>collect</dt>
<dd><p>Should the data be retrieved as a local tibble?
If <code>FALSE</code> (the default), a <code>tbl_lazy</code> object is returned
(lazy query).
Hence the result can be further built upon before retrieving data with
<code><a href="https://dplyr.tidyverse.org/reference/compute.html" class="external-link">collect()</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>By default, a <code>tbl_lazy</code> object.
With <code>collect = TRUE</code> or with a specified <code>mask</code>,
a local <code><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></code> is returned.
(TO BE ADDED: Explanation on the variable names of the returned object)</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>(TO BE ADDED: Explanation on the different available values of loc_type
and loc_validity)</p>
<p>The lazy object returns a <code>loc_wid</code> variable, for further use in
<em>remote</em> queries.
However, don't use it in local objects: <code>loc_wid</code> is not to be
regarded as stable.
Therefore, <code>collect = TRUE</code> does not return <code>loc_wid</code>.</p>
<p>The result also provides metadata at the level of the observation
well, even when <code>obswells = FALSE</code>.
In the latter case, this refers to the variables
<code>soilsurf_ost</code>,
<code>measuringref_ost</code>,
<code>tubelength</code>,
<code>filterlength</code>,
<code>filterdepth</code>.
See the argument <code>obswell_aggr</code> for options of how to aggregate this
information at the location level;
by default the latest observation well is used
(per location) that meets the criteria on filterdepth.
Mind that <code>obswells = FALSE</code> and <code>filterdepth_na = TRUE</code> may lead
to missing filterdepth values at locations which do have a
value for an older observation well, but not for the most recent one.</p>
<p>Please note the meaning of observation well in Watina: if there are multiple
observation wells attached to one location, these belong to
<em>other timeframes</em>!
So one location always coincides with exactly one observation well at
one moment in time.
Multiple observation wells can succeed one another because of physical
alterations (e.g. damage of a piezometer).
Here, the term 'observation well' is used to refer to a fixed installed
device in the field (groundwater piezometer, surface water level
measurement device).</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Up to and including <code>watina 0.3.0</code>, the result was sorted according to
<code>area_code</code> and <code>loc_code</code>,
both for the lazy query and the collected result.
Later versions avoid sorting in case of a lazy result, because
otherwise, when using the result inside another lazy query, this led to
'ORDER BY' constructs in SQL subqueries, which must be avoided.
If you like to print the lazy object in a sorted manner, you must add
<code>%&gt;% arrange(...)</code> yourself.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other functions to query the database: 
<code><a href="get_chem.html">get_chem</a>()</code>,
<code><a href="get_xg3.html">get_xg3</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="va">watina</span> <span class="op">&lt;-</span> <span class="fu"><a href="connect_watina.html">connect_watina</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         bbox <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="fl">1.4e+5</span>,</span>
<span class="r-in">                  xmax <span class="op">=</span> <span class="fl">1.7e+5</span>,</span>
<span class="r-in">                  ymin <span class="op">=</span> <span class="fl">1.6e+5</span>,</span>
<span class="r-in">                  ymax <span class="op">=</span> <span class="fl">1.9e+5</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">area_code</span>, <span class="va">loc_code</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KAL"</span>, <span class="st">"KBR"</span><span class="op">)</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KAL"</span>, <span class="st">"KBR"</span><span class="op">)</span>,</span>
<span class="r-in">         loc_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"S"</span><span class="op">)</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="st">"WES"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="st">"WES"</span>,</span>
<span class="r-in">         filterdepth_guess <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KAL"</span>, <span class="st">"KBR"</span><span class="op">)</span>,</span>
<span class="r-in">         loc_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"S"</span><span class="op">)</span>,</span>
<span class="r-in">         filterdepth_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Mark the different output of:</span></span>
<span class="r-in">  <span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">           loc_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KBRP081"</span>, <span class="st">"KBRP090"</span>, <span class="st">"KBRP095"</span>, <span class="st">"KBRS001"</span><span class="op">)</span>,</span>
<span class="r-in">           loc_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"S"</span><span class="op">)</span>,</span>
<span class="r-in">           collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in">  <span class="co"># versus:</span></span>
<span class="r-in">  <span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">           loc_vec <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KBRP081"</span>, <span class="st">"KBRP090"</span>, <span class="st">"KBRP095"</span>, <span class="st">"KBRS001"</span><span class="op">)</span>,</span>
<span class="r-in">           collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Returning all individual observation wells:</span></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         obswells <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KAL"</span>, <span class="st">"KBR"</span><span class="op">)</span>,</span>
<span class="r-in">         loc_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="st">"S"</span><span class="op">)</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Different examples of aggregating observation wells at location level:</span></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="st">"WES"</span>,</span>
<span class="r-in">         filterdepth_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         filterdepth_guess <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         obswell_aggr <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">loc_code</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ost"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"filterdepth"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         area_codes <span class="op">=</span> <span class="st">"WES"</span>,</span>
<span class="r-in">         filterdepth_na <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         filterdepth_guess <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span class="r-in">         obswell_aggr <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span class="r-in">         collect <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">loc_code</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"ost"</span><span class="op">)</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains</a></span><span class="op">(</span><span class="st">"filterdepth"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Selecting all piezometers with status VLD of the</span></span>
<span class="r-in"><span class="co"># province "West-Vlaanderen" (current polygon taken</span></span>
<span class="r-in"><span class="co"># from the official WFS service):</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://httr.r-lib.org/" class="external-link">httr</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">mymask</span> <span class="op">&lt;-</span></span>
<span class="r-in">    <span class="st">"https://geoservices.informatievlaanderen.be/overdrachtdiensten/VRBG/wfs"</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://httr.r-lib.org/reference/parse_url.html" class="external-link">parse_url</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://purrr.tidyverse.org/reference/list_modify.html" class="external-link">list_merge</a></span><span class="op">(</span>query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>request <span class="op">=</span> <span class="st">"GetFeature"</span>,</span>
<span class="r-in">                            typeName <span class="op">=</span> <span class="st">"VRBG:Refprv"</span>,</span>
<span class="r-in">                            cql_filter<span class="op">=</span><span class="st">"NAAM='West-Vlaanderen'"</span>,</span>
<span class="r-in">                            srsName <span class="op">=</span> <span class="st">"EPSG:31370"</span>,</span>
<span class="r-in">                            outputFormat <span class="op">=</span> <span class="st">"text/xml; subtype=gml/3.1.1"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://httr.r-lib.org/reference/parse_url.html" class="external-link">build_url</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">read_sf</a></span><span class="op">(</span>crs <span class="op">=</span> <span class="fl">31370</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span class="r-in">    <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_cast.html" class="external-link">st_cast</a></span><span class="op">(</span><span class="st">"GEOMETRYCOLLECTION"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">get_locs</span><span class="op">(</span><span class="va">watina</span>,</span>
<span class="r-in">         loc_validity <span class="op">=</span> <span class="st">"VLD"</span>,</span>
<span class="r-in">         mask <span class="op">=</span> <span class="va">mymask</span>,</span>
<span class="r-in">         buffer <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Disconnect:</span></span>
<span class="r-in"><span class="fu"><a href="dbDisconnect.html">dbDisconnect</a></span><span class="op">(</span><span class="va">watina</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Floris Vanderhaeghe.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

